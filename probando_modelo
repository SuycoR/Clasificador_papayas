import numpy as np
from tensorflow.keras.preprocessing import image
from tensorflow.keras.models import load_model

# Cargar modelo previamente entrenado
model = load_model("modelo_mobilenetv2_papayas.h5")

# Ruta de la imagen de prueba
img_path = "resized/test/mature/aug_Mature_004_0_2389.jpg"

# Preprocesar imagen
img = image.load_img(img_path, target_size=(224, 224))  # Debe coincidir con el tamaño usado en entrenamiento
img_array = image.img_to_array(img)
img_array = np.expand_dims(img_array, axis=0)  # Forma (1, 224, 224, 3)
img_array = img_array / 255.0  # Normalizar

# Predecir
preds = model.predict(img_array)
predicted_class = np.argmax(preds, axis=1)[0]

# Mostrar resultado
print(f"🔍 Predicción: {class_names[predicted_class]}")